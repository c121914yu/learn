<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>threejs</title>
  <style type="text/css">
    body{
      margin: 0;
      overflow: hidden;
    }
  </style>
  <script src="http://www.yanhuangxueyuan.com/threejs/build/three.js"></script>
  <script src="http://www.yanhuangxueyuan.com/threejs/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
  <script>
    //初始化环境
    var scene = new THREE.Scene()
    
    //创建模型
    var geometry = new THREE.BoxGeometry(40, 60, 40);
    var material = new THREE.MeshLambertMaterial({
      color: 0x0000ff
    });
    var mesh = new THREE.Mesh(geometry, material);
    // mesh.position.set(0,0,0)
    scene.add(mesh);
    // 设置产生投影的网格模型
    mesh.castShadow = true;
    
    //创建一个平面几何体作为投影面
    var planeGeometry = new THREE.PlaneGeometry(300, 300);
    var planeMaterial = new THREE.MeshLambertMaterial({
      color: 0xf4f4f4,
    });
    // 平面网格模型作为投影面
    var planeMesh = new THREE.Mesh(planeGeometry, planeMaterial);
    scene.add(planeMesh); //网格模型添加到场景中
    planeMesh.rotateX(-Math.PI / 2); //旋转网格模型
    planeMesh.position.y = -30; //设置网格模型y坐标
    // 设置接收阴影的投影面
    planeMesh.receiveShadow = true;
    
    //环境光
    var ambient = new THREE.AmbientLight(0x444444)
    scene.add(ambient)
    
    //点光源
    // var light = new THREE.PointLight(0xffffff)
    // light.position.set(100,100,100)
    // light.castShadow = true
    // scene.add(light)
    // light.shadow.camera.near = 0.5;     
    // light.shadow.camera.far = 400   
    // light.shadow.mapSize.set(1024,1024)
    
    //平行型
    var light = new THREE.DirectionalLight( 0xffffff, 1, 100 );
    light.position.set( 80, 80, 80 ); 			//default; light shining from top
    light.castShadow = true;            // default false
    scene.add( light );
    //Set up shadow properties for the light
    light.shadow.mapSize.set(1024,1024)
    light.shadow.camera.near = 0.5;    // default
    light.shadow.camera.far = 300;     // default
    light.shadow.camera.left = -50;
    light.shadow.camera.right = 50;
    light.shadow.camera.top = 50;
    light.shadow.camera.bottom = -50;
    
    //聚光灯
    // var light = new THREE.SpotLight(0xffffff,1);
    // // 设置聚光光源位置
    // light.position.set(200, 150, 200);
    // // 设置聚光光源发散角度
    // light.angle = Math.PI / 3
    // scene.add(light); //光对象添加到scene场景中
    // // 设置用于计算阴影的光源对象
    // light.castShadow = true;
    // // 设置计算阴影的区域，注意包裹对象的周围
    // light.shadow.camera.near = 1;
    // light.shadow.camera.far = 500;
    // light.shadow.camera.fov = 20;
    // light.shadow.mapSize.set(1024,1024)
    
    var helper = new THREE.CameraHelper( light.shadow.camera );
    scene.add( helper );
    
    //设置相机
    var width = window.innerWidth; 
    var height = window.innerHeight; 
    var k = width / height; //窗口宽高比
    var s = 200; //三维场景显示范围控制系数，系数越大，显示的范围越大
    var camera = new THREE.OrthographicCamera(-s * k, s * k, s, -s, 1, 1000);
    camera.position.set(200, 300, 200); //设置相机位置
    camera.lookAt(scene.position); //设置相机方向(指向的场景对象)
    //渲染对象
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(width, height);//设置渲染区域尺寸
    renderer.setClearColor(0xb9d3ff, 1); //设置背景颜色
    renderer.shadowMap.enabled = true;
    document.body.appendChild(renderer.domElement); //body元素中插入canvas对象
    
    //辅助坐标系
    var AxesHelper= new THREE.AxesHelper(1000);
    scene.add(AxesHelper);
    
    function render(){
      renderer.render(scene, camera);
      requestAnimationFrame(render)
    }
    render()
    var controls = new THREE.OrbitControls(camera,renderer.domElement);//创建控件对象
  </script>
</body>
</html>
